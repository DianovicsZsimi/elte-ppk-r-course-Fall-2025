<<<<<<< Updated upstream
<<<<<<< Updated upstream
geom_histogram() +
#xlim(0, NA) +
#ylim(0, NA) +
theme_minimal()
=======
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] - 1
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
for(col in x_cols) {
if(col %in% first_step_bias) {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-4, 4), 1)
first_step_bias <- setdiff(first_step_bias, col)
} else {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
>>>>>>> Stashed changes
}
}
bias_length <- 3  # number of steps to apply bias
bias_value <- 1   # step in same direction
if(col %in% first_step_bias) {
if(bias_length_remaining[[col]] > 0) {
new_row[[col]] <- data[[col]][nrow(data)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
} else {
# normal ±1 random walk after bias
new_row[[col]] <- data[[col]][nrow(data)] + sample(c(-1, 1), 1)
first_step_bias <- setdiff(first_step_bias, col)
}
}
data_3 <- bind_rows(data_3, new_row)
}
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
View(data_3)
first_step_bias <- c()
bias_length <- 3   # number of biased steps
bias_value <- 1    # step size in same direction
bias_length_remaining <- c()  # named vector to track remaining biased steps per fork
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] + 1
# Get current x columns
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
# Apply biased steps for forks
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
# Normal ±1 step
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
# Check forks for each path
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
# Duplicate current value to new fork column
new_row[[fork_col]] <- new_row[[col]]
# Initialize bias tracking for this new fork
bias_length_remaining[[fork_col]] <- bias_length
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
n_steps <- 200
fork_prob <- 0.01
data_3 <- tibble(y = 200, x = 500)
fork_count <- 0
first_step_bias <- c()
bias_length <- 3   # number of biased steps
bias_value <- 1    # step size in same direction
bias_length_remaining <- c()  # named vector to track remaining biased steps per fork
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] - 1
# Get current x columns
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
# Apply biased steps for forks
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
# Normal ±1 step
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
# Check forks for each path
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
# Duplicate current value to new fork column
new_row[[fork_col]] <- new_row[[col]]
# Initialize bias tracking for this new fork
bias_length_remaining[[fork_col]] <- bias_length
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
n_steps <- 200
fork_prob <- 0.01
data_3 <- tibble(y = 200, x = 500)
fork_count <- 0
# Track forks that need gradual bias
bias_length <- 3   # number of biased steps
bias_value <- 1    # step size in same direction
bias_length_remaining <- c()  # named vector
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] + 1
# Get current x columns (including existing forks)
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
# Step all existing columns
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
# Now check forks for each column
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
new_row[[fork_col]] <- new_row[[col]]  # duplicate value
bias_length_remaining[[fork_col]] <- bias_length  # bias for first steps
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] - 1
# Get current x columns (including existing forks)
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
# Step all existing columns
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
# Now check forks for each column
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
new_row[[fork_col]] <- new_row[[col]]  # duplicate value
bias_length_remaining[[fork_col]] <- bias_length  # bias for first steps
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
View(data_3)
n_steps <- 200
fork_prob <- 0.01
data_3 <- tibble(y = 200, x = 500)
fork_count <- 0
# Track forks that need gradual bias
bias_length <- 3   # number of biased steps
bias_value <- 1    # step size in same direction
bias_length_remaining <- c()  # named vector
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] - 1
# Get current x columns (including existing forks)
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
# Step all existing columns
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
# Now check forks for each column
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
new_row[[fork_col]] <- new_row[[col]]  # duplicate value
bias_length_remaining[[fork_col]] <- bias_length  # bias for first steps
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
n_steps <- 200
fork_prob <- 0.01
data_3 <- tibble(y = 200, x = 500)
fork_count <- 0
# Track forks that need gradual bias
bias_length <- 6   # number of biased steps
bias_value <- 1    # step size in same direction
bias_length_remaining <- c()  # named vector
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] - 1
# Get current x columns (including existing forks)
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
# Step all existing columns
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
# Now check forks for each column
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
new_row[[fork_col]] <- new_row[[col]]  # duplicate value
bias_length_remaining[[fork_col]] <- bias_length  # bias for first steps
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
library(gganimate)
install.packages("gganimate")
animation = ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank()) +
transition_manual(frames = y, cumulative = TRUE)
library(gganimate)
animation = ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank()) +
transition_manual(frames = y, cumulative = TRUE)
animated_plot <- animate(animation, width = 1350, height = 1468,  res = 300)
animated_plot
anim_save("lightning.gif", animated_plot)
anim_save("lightning.gif", animated_plot, renderer = gifski_renderer())
anim_save("lightning.gif", animated_plot, renderer = gifski_renderer(), device = "png")
rlang::last_trace()
anim_save("lightning.gif", animation = animated_plot, renderer = gifski_renderer(), device = "png", save_animation(animated_plot, "lightning.gif"))
save_animation(animation = animated_plot, "lightning.gif")
animated_plot <- animate(animation, width = 1350, height = 1468,  res = 300, renderer = gifski_renderer())
library(here)
here::i_am("README.md")
animated_plot <- animate(animation, width = 1350, height = 1468,  res = 300, renderer = gifski_renderer())
animated_plot
anim_save(here::here("assignments/lightning.gif", duration = 5, fps = 20,  animation = animated_plot)
c
c
c
animated_plot <- animate(animation, width = 500, height = 500,  res = 300, renderer = gifski_renderer())
animated_plot
anim_save(here::here("assignments/lightning.gif", duration = 5, fps = 20,  animation = animated_plot)
n_steps <- 200
n_steps <- 200
fork_prob <- 0.01
data_3 <- tibble(y = 1, x = 500)
fork_count <- 0
bias_length <- 6
bias_value <- 1
bias_length_remaining <- c()
for(i in 1:n_steps) {
new_y <- data_3$y[nrow(data_3)] + 1
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
new_row <- tibble(y = new_y)
for(col in x_cols) {
if(col %in% names(bias_length_remaining)) {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + bias_value
bias_length_remaining[[col]] <- bias_length_remaining[[col]] - 1
if(bias_length_remaining[[col]] == 0) {
bias_length_remaining <- bias_length_remaining[!names(bias_length_remaining) %in% col]
}
} else {
new_row[[col]] <- data_3[[col]][nrow(data_3)] + sample(c(-1, 1), 1)
}
}
for(col in x_cols) {
if(runif(1) < fork_prob) {
fork_count <- fork_count + 1
fork_col <- paste0("x_fork_", fork_count)
new_row[[fork_col]] <- new_row[[col]]
bias_length_remaining[[fork_col]] <- bias_length
}
}
data_3 <- bind_rows(data_3, new_row)
}
x_cols <- names(data_3)[str_detect(names(data_3), "^x")]
data_3_long <- data_3 %>%
pivot_longer(
cols = all_of(x_cols),
names_to = "path",
values_to = "x"
)
<<<<<<< Updated upstream
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0, size = 3.5, show.legend = FALSE) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0.5, size = 3.5, show.legend = FALSE) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = -0.2, size = 3.5, show.legend = FALSE) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = -0.2, size = 3.5, show.legend = FALSE,
vjust = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = -0.2, size = 3.5, show.legend = FALSE,
vjust = -0.2) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = -0.2, size = 3.5, show.legend = FALSE,
vjust = -0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = -0.2, size = 3.5, show.legend = FALSE,
vjust = -2) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = -0.2, size = 3.5, show.legend = FALSE,
vjust = -1.5) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0, size = 3.5, show.legend = FALSE,
vjust = -1.5) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0, size = 3.5, show.legend = FALSE,
vjust = -1.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
#geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0, size = 3.5, show.legend = FALSE,
vjust = -1.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(, size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0, size = 3.5, show.legend = FALSE,
vjust = -1.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
ggplot(combined, aes(x = estimate, y = term, color = model)) +
geom_point(position = position_dodge(width = 0.6), size = 3) +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high),
position = position_dodge(width = 0.6), height = 0.2) +
geom_text(aes(label = round(estimate, 2)),
position = position_dodge(width = 1),
hjust = 0, size = 3.5, show.legend = FALSE,
vjust = -1.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
theme_minimal(base_size = 14) +
labs(
title = "Model comparison",
x = "Estimate (with 95% CI)",
y = "Term",
color = "Model"
)
summary(model_a)
model_a = lmer(pain ~ pain_cat + stai + mindfulness + cortisol_serum + age + sex + (1|hospital), data = data_a_clean)
View(model_a)
preds <- predict(model_a, newdata = data_b, re.form = NA)
View(data_b)
data_b_clean = data_b |>
rename(stai = STAI_trait) |>
mutate(ID = as.integer(str_remove(ID, "ID_")),
hospital = as.factor(str_remove(hospital, "hospital_")),
sex = as.factor(str_to_lower(sex)))
preds <- predict(model_a, newdata = data_b_clean, re.form = NA)
preds <- predict(model_a, newdata = data_b_clean)
preds <- predict(model_a, newdata = data_b_clean, allow.new.levels = T)
library(Metrics)
install.packages("Metrics")
library(Metrics)
rmse(data_test$y, preds)
mae(data_b_clean$y, preds)
mae(data_b_clean$pain, preds)
rmse(data_b_clean$pain, preds)
residuals_b <- data_b_clean$pain - prediction_b
prediction_b <- predict(model_a, newdata = data_b_clean, allow.new.levels = T)
residuals_b <- data_b_clean$pain - prediction_b
# RSS
RSS <- sum(resid_B^2)
RSS <- sum(residuals_b^2)
# TSS
TSS <- sum((data_b_clean$pain - mean(data_b_clean$pain))^2)
# R² on data_B
R2_B <- 1 - (RSS/TSS)
R2_B
summary(model_a)
summary = summary(model_a)
View(summary)
coef(model_a)
confint(model_a)
r2_nakagawa(model_a)
str(summary(model_a))
install.packages("MuMIn")
library(MuMIn)
r.squaredGLMM(fit1.lme)
r.squaredGLMM(model_a)
r.squaredGLMM(model_a)
R2_B
tab_model(model_a)
=======
if (!require("gridExtra")) install.packages("gridExtra")
library(gridExtra)
if (!require("psych")) install.packages("psych")
library(psych)
if (!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
data <- read_csv("https://raw.githubusercontent.com/kekecsz/PSZB17-210-Data-analysis-seminar/refs/heads/master/seminar_04/StudentPerformanceFactors.csv")
data
View(data)
data = read_csv("https://raw.githubusercontent.com/kekecsz/PSZB17-210-Data-analysis-seminar/refs/heads/master/seminar_04/StudentPerformanceFactors.csv")
data  |>
select(Attendance) |>
summary()
data |>
summary()
min(data$Attendance)
data |>
summarize(min(Attendance, na.rm = TRUE))
min_attendance = data |>
summarize(min(Attendance, na.rm = TRUE))
View(min_attendance)
data |>
filter(Access_to_Resources == "Low") |>
summarize(mean(Sleep_Hours, na.rm = TRUE))
data |>
select(Hours_Studied, Attendance, Exam_Score) |>
describe()
data |>
ggplot(aes(x = Exam_Score)) +
geom_histogram()
data |>
select(Hours_Studied, Attendance, Exam_Score) |>
describe()
table(data$Parental_Education_Level)
data |>
select(Gender) |>
summary()
data <- data |>
mutate(Parental_Education_Level = factor(Parental_Education_Level),
Parental_Involvement = factor(Parental_Involvement),
Access_to_Resources = factor(Access_to_Resources),
Extracurricular_Activities = factor(Extracurricular_Activities),
Motivation_Level = factor(Motivation_Level),
Internet_Access = factor(Internet_Access),
Family_Income = factor(Family_Income),
Teacher_Quality = factor(Teacher_Quality),
School_Type = factor(School_Type),
Peer_Influence = factor(Peer_Influence),
Learning_Disabilities = factor(Learning_Disabilities),
Distance_from_Home = factor(Distance_from_Home),
Gender = factor(Gender))
data = data |>
mutate(Gender = factor(Gender))
data |>
select(Gender) |>
summary()
levels(data$Parental_Education_Level)
levels(data$Gender)
levels(data$Gender)
levels(data$Gender)
table(data$School_Type)
data |>
filter(Gender != "Male") |>
select(Exam_Score, School_Type) |>
summary()
data_no_hs = data |>
filter(School_Type != "Home")
levels(data_no_hs$School_Type)
data |>
ggplot() +
aes(x = Access_to_Resources) +
geom_bar()
data = data |>
mutate(Access_to_Resources = factor(Access_to_Resources, levels = c("Low",
"Medium",
"High")))
data |>
ggplot() +
aes(x = Access_to_Resources) +
geom_bar()
head(data$Access_to_Resources)
levels(data$Access_to_Resources)
summary(data$Access_to_Resources)
head(data$Access_to_Resources)
data |>
mutate(Access_to_Resources = factor(Access_to_Resources, ordered = T, levels = c("Low",
"Medium",
"High")))
data = data |>
mutate(Grade = factor(
case_when(Exam_Score < 60 ~ "Poor",
Exam_Score >= 60 & Exam_Score < 80 ~ "Good",
Exam_Score > 80 ~ "Excellent"), levels = c("Poor",
"Good", "Excellent"),
ordered = T))
levels(data$Grade)
data = data |>
mutate(Grade_passfail = factor(recode(Grade,
"Poor" = "Failed",
"Good" = "Passed",
"Excellent" = "Passed")))
levels(data$Grade_passfail)
data = data |>
filter(School_Type != "Home") |>
mutate(sleep_categorical = factor(case_when(Sleep_hours < 6 ~ "inadequate",
Sleep_hourse >= 6 ~ "adequate"),
levels = c("inadequate", "adequate")))
# szurd az adatokat ugy hogy ne legyenek benne az otthon tanulo (School_Type == "Home")
# hallgatok.
# csinalj egy uj kategorikus valtozot (nevezzuk ezt sleep_categorical-nak)
# a mutate() funkcio hasznalataval amiben azok a tanulok,
# ahol a  *Sleep_Hours* valtozo 6 alatt van "inadequate",
# ahol 6 vagy a felett van "adequate" kategoriaba keruljenek.
# figyelj oda hogy faktorkent jelold meg ezt az uj valtozot
# (Ezt lehet az elozo lepesben a mutate() funkcion belul,
# vagy egy kulon lepesben, de mindenkeppen a factor()
# vagy az as.factor() funkciokat erdemes hozza hasznalni)
data = data |>
filter(School_Type != "Home") |>
mutate(sleep_categorical = factor(case_when(Sleep_hours < 6 ~ "inadequate",
Sleep_hours >= 6 ~ "adequate"),
levels = c("inadequate", "adequate")))
# szurd az adatokat ugy hogy ne legyenek benne az otthon tanulo (School_Type == "Home")
# hallgatok.
# csinalj egy uj kategorikus valtozot (nevezzuk ezt sleep_categorical-nak)
# a mutate() funkcio hasznalataval amiben azok a tanulok,
# ahol a  *Sleep_Hours* valtozo 6 alatt van "inadequate",
# ahol 6 vagy a felett van "adequate" kategoriaba keruljenek.
# figyelj oda hogy faktorkent jelold meg ezt az uj valtozot
# (Ezt lehet az elozo lepesben a mutate() funkcion belul,
# vagy egy kulon lepesben, de mindenkeppen a factor()
# vagy az as.factor() funkciokat erdemes hozza hasznalni)
data = data |>
filter(School_Type != "Home") |>
mutate(sleep_categorical = factor(case_when(Sleep_Hours < 6 ~ "inadequate",
Sleep_Hours >= 6 ~ "adequate"),
levels = c("inadequate", "adequate")))
data |>
ggplot() +
aes(x = Access_to_Resources) +
geom_bar()
data |>
ggplot() +
aes(x = Exam_Score) +
geom_histogram()
data |>
ggplot() +
aes(x = Exam_Score) +
geom_density()
data |>
ggplot() +
aes(x = Exam_Score) +
geom_histogram()
data |>
select(Exam_Score) |>
summary()
feladat_data = data |>
select(Previous_Scores, Peer_Influence, Parental_Involvement, Sleep_Hours)
summary(feladat_data)
sum(is.na(data$Previous_Scores))
sum(is.na(data$Peer_Influence))
sum(is.na(data$Sleep_Hours))
sum(is.na(data$Parental_Involvement))
data |>
ggplot(aes(x = Sleep_Hours)) +
geom_histogram()
data_corrected <- data |>
mutate(Exam_Score = replace(Exam_Score,  Exam_Score=="101", NA))
data_corrected |>
select(Exam_Score) |>
summary()
data_corrected |>
drop_na(Family_Income) |>
ggplot() +
aes(x = Internet_Access, fill = Family_Income) +
geom_bar()
data_corrected |>
drop_na(Family_Income) |>
ggplot() +
aes(x = Internet_Access, fill = Family_Income) +
geom_bar(position = "fill")
freq_plot <- data_corrected |>
drop_na(Family_Income) |>
ggplot() +
aes(x = Internet_Access, fill = Family_Income) +
geom_bar()
proportion_plot <- data_corrected |>
drop_na(Family_Income) |>
ggplot() +
aes(x = Internet_Access, fill = Family_Income) +
geom_bar(position = "fill") +
ylab("proportion")
grid.arrange(freq_plot, proportion_plot, nrow=2)
barchart_plot_3 <-
data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = sleep_categorical, fill = Family_Income) +
geom_bar() +
theme(legend.position="bottom") +
guides(fill = guide_legend(title.position = "bottom"))
barchart_plot_3
data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = sleep_categorical, fill = Family_Income) +
geom_bar()
data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = sleep_categorical, fill = Family_Income) +
geom_bar() +
theme_minimal()
barchart_plot_3 <-
data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = sleep_categorical, fill = Family_Income) +
geom_bar() +
theme_classic()
data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = sleep_categorical, fill = Family_Income) +
geom_bar() +
theme_classic()
plot_5 <- data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = Family_Income, fill = sleep_categorical) +
geom_bar(position = "dodge")
plot_6 <- data_corrected |>
select(sleep_categorical, Family_Income) |>
drop_na() |>
ggplot() +
aes(x = Family_Income) +
geom_bar() +
facet_wrap(~ sleep_categorical)
grid.arrange(plot_5, plot_6, nrow=2)
data_corrected |>
group_by(Learning_Disabilities) |>
summarise(mean_exam = mean(Exam_Score, na.rm = T),
median_exam = median(Exam_Score, na.rm = T),
sd_exam = sd(Exam_Score, na.rm = T)) |>
ggplot(aes(y = mean_exam, x = Learning_Disabilities)) +
geom_bar(stat = "identity") +
geom_point(aes(y = median_exam), color = "red", size = 2)
t.test(Exam_Score ~ Learning_Disabilities, data = data_corrected, alternative = "two.sided")
data_corrected |>
select(Exam_Score, Hours_Studied) |>
drop_na() |>
cor()
data_corrected |>
select(Exam_Score, Hours_Studied, Tutoring_Sessions) |>
drop_na() |>
ggplot() +
aes(x = Exam_Score, y = Hours_Studied, col = Tutoring_Sessions) +
geom_point()+
scale_colour_gradientn(colours=c("green","black"))
>>>>>>> Stashed changes
=======
# Visualize new model
ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank())
# Animate the model
animation = ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(200, 0) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank()) +
transition_manual(frames = y, cumulative = TRUE)
animation = ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(0, 200) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank()) +
transition_manual(frames = y, cumulative = TRUE)
animated_plot <- animate(animation, width = 500, height = 500,  res = 300, renderer = gifski_renderer())
animated_plot
anim_save(here::here("assignments/lightning.gif", duration = 5, fps = 20,  animation = animated_plot)
animation = ggplot(data_3_long, aes(x = x, y = y)) +
animation = ggplot(data_3_long, aes(x = x, y = y)) +
geom_point(shape = 21, fill = "white", color = "blue", size = 0.7) +
ylim(200, 0) +
xlim(400, 600) +
theme(panel.background = element_rect(fill = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank()) +
transition_manual(frames = y, cumulative = TRUE)
animated_plot <- animate(animation, width = 500, height = 500,  res = 300, renderer = gifski_renderer())
animated_plot
anim_save(here::here("assignments/lightning.gif", duration = 5, fps = 20,  animation = animated_plot)
animated_plot <- animate(animation, width = 500, height = 500,  res = 100, renderer = gifski_renderer())
animated_plot <- animate(animation, width = 500, height = 500,  res = 100, renderer = gifski_renderer())
animated_plot
anim_save(here::here("assignments/lightning.gif", animation = animated_plot)
anim_save(here::here("assignments/lightning.gif", animation = animated_plot))
anim_save(here::here("assignments/lightning.gif", animation = animated_plot))
anim_save(here::here("assignments/lightning.gif", animation = animated_plot))
anim_save("lightning.gif", animation = animated_plot)
anim_save("lightning.gif", duration = 4, fps = 25, animation = animated_plot)
anim_save("lightning.gif", fps = 50, animation = animated_plot)
animated_plot <- animate(animation, width = 500, height = 500,  res = 100, duration = 3, renderer = gifski_renderer())
animated_plot
anim_save("lightning.gif", duration = 3, animation = animated_plot)
>>>>>>> Stashed changes
